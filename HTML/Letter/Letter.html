<!DOCTYPE html>
<head>
    <meta charset="utf-8">
    <title>Lettre à ouvrir</title>
    <link href="Letter.css" rel="stylesheet">
</head>
<body>
    <div class="container">
        <div class="header">
            <h1>Tu as une lettre à ouvrir !</h1>
            <p>Veux-tu l'ouvrir ?</p>
        </div>
        <button class="ouiBtn">Oui</button>
        <button class="nonBtn">Non</button>
        <p class="boring"></p>
    </div>
    <canvas id="confetti"></canvas>
    <script>
        const ouiBtn = document.querySelector('.ouiBtn');
        const nonBtn = document.querySelector('.nonBtn');
        const container = document.querySelector('.container');
        const canvas = document.getElementById('confetti');
        const ctx = canvas.getContext('2d');
        const title = document.querySelector('h1');
        const boring = document.querySelector('.boring');
        let nonleft = true;

        let nonhappened = 0;
        let nonend = false;
        let tries = 0;

        canvas.width = window.innerWidth;
        canvas.height = window.innerHeight;

        let confettis = [];
        function createConfettis() {
            for (let i = 0; i < 150; i++) {
                confettis.push({
                    x: Math.random() * canvas.width,
                    y: Math.random() * canvas.height - canvas.height,
                    size: Math.random() * 6 + 4,
                    speed: Math.random() * 3 + 2,
                    color: `hsl(${Math.random() * 360}, 100%, 60%)`
                });
            }
        }

        function animateConfettis() {
            ctx.clearRect(0, 0, canvas.width, canvas.height);
            confettis.forEach((c,i) => {
                c.y += c.speed;
                ctx.fillStyle = c.color;
                ctx.fillRect(c.x, c.y, c.size, c.size);

                if (c.y > canvas.height) {
                    confettis.splice(i, 1);
                }
            });
            if (confettis.length > 0) {
                requestAnimationFrame(animateConfettis);
            }
        }

        nonBtn.style.left = '60%';
        nonBtn.style.top = '60%';
        nonBtn.style.transform = 'translate(-50%, -50%)';

        nonBtn.addEventListener('mouseenter', () => {
            if (tries === 51) {
                boring.textContent = "Ou pas. (Sitoplé clique Oui)";
                if (nonleft) {
                    nonBtn.style.left = "40%";
                    ouiBtn.style.left = "60%";
                    nonleft = false;
                } else {
                    nonBtn.style.left = "60%";
                    ouiBtn.style.left = "40%";
                    nonleft = true;
                }
                tries ++;
            } else if (tries > 51 && tries <= 65) {
                if (nonleft) {
                    nonBtn.style.left = "40%";
                    ouiBtn.style.left = "60%";
                    nonleft = false;
                } else {
                    nonBtn.style.left = "60%";
                    ouiBtn.style.left = "40%";
                    nonleft = true;
                }
                tries ++;
            } else if (tries > 65) {
                nonBtn.textContent = "Oui";
                nonBtn.style.backgroundColor = "green";
            }
            if (nonend) {
                nonBtn.style.transform = 'none';
                const maxX = container.clientWidth - nonBtn.offsetWidth;
                const maxY = container.clientHeight - nonBtn.offsetHeight;
                nonBtn.style.left = Math.random() * maxX + 'px';
                nonBtn.style.top = Math.random() * maxY + 'px';
                if (tries === 10) {
                    boring.textContent = "Tu es fatiguante...";
                    boring.style.opacity = '0';
                    boring.style.transition = "none";
                } else if (tries === 20) {
                    boring.textContent = "Juste clique sur Oui ;-;";
                    boring.style.opacity = '0';
                    boring.style.transition = "none";
                    boring.style.color = "deepskyblue";
                } else if (tries === 30) {
                    boring.textContent = "Bon OK tu as le droit de cliquer...";
                    boring.style.color = "black";
                    nonBtn.disabled = false;
                    nonend = false;
                } else if (tries === 31) {
                    boring.textContent = "ET TU CONTINUES !";
                    boring.style.opacity = '0';
                    boring.style.transition = "none";
                } else if (tries === 40) {
                    boring.textContent = "STOOOOP !";
                    boring.style.opacity = '0';
                    boring.style.transition = "none";
                } else if (tries === 50) {
                    boring.textContent = "Tu as gagné...";
                    nonBtn.disabled = true;
                    boring.style.color = "black";
                    nonend = false;
                    nonBtn.style.left = '60%';
                    nonBtn.style.top = '60%';
                    nonBtn.style.transform = 'translate(-50%, -50%)';
                }
                void boring.offsetWidth;
                boring.style.transition = "opacity 3s ease";
                boring.style.opacity = '1';
                tries ++;
            }
        });

        nonBtn.addEventListener('click', () => {
            nonhappened ++;
            if (nonhappened === 1) {
                ouiBtn.style.opacity = "0";
                ouiBtn.disabled = true;
                document.body.style.backgroundColor = '#000';
                title.textContent = "Ce n'était pas sensé arriver.";
                title.style.color = "red";
                nonBtn.style.left = '50%';
                nonBtn.textContent = "Ok ?";
                title.style.opacity = '0';
                title.style.transition = "none";
            } else if (nonhappened === 2) {
                title.textContent = 'Tu casses la tête, tu peux plus toucher "Non", toc...';
                nonBtn.textContent = "T'es infernal";
                title.style.opacity = '0';
                title.style.transition = "none";
            } else if (nonhappened === 3) {
                ouiBtn.style.opacity = "1";
                ouiBtn.disabled = false;
                nonBtn.disabled = true;
                nonBtn.style.color = "black";
                document.body.style.backgroundColor = "#FFF";
                title.textContent = "Tu as une lettre à ouvrir !"
                title.style.color = "black";
                nonBtn.style.left = "60%";
                nonBtn.textContent = "Non";
                nonend = true;
            } else {
                boring.textContent = "Tu as vraiment cru ? Naïve...";
                nonBtn.disabled = true;
                nonBtn.style.color = "black";
                nonend = true;
                nonBtn.style.transform = 'none';
                const maxX = container.clientWidth - nonBtn.offsetWidth;
                const maxY = container.clientHeight - nonBtn.offsetHeight;
                nonBtn.style.left = Math.random() * maxX + 'px';
                nonBtn.style.top = Math.random() * maxY + 'px';
            }
            void title.offsetWidth;
            title.style.transition = "opacity 3s ease";
            title.style.opacity = '1';
        });

        ouiBtn.addEventListener('click', () => {
            if (boring.textContent !== "") {
                boring.textContent = "Merci ! =D";
            }
            ouiBtn.style.opacity = "0";
            ouiBtn.disabled = true;
            ouiBtn.style.cursor = "default";
            nonBtn.style.opacity = "0";
            nonBtn.disabled = true;
            nonBtn.style.cursor = "default";
            document.body.classList.add("yesPressed");
            document.querySelector('h1').textContent = "Tu as un petit QR code à scanner !";
            document.querySelector('p').textContent = "Yeeey !";
            createConfettis();
            animateConfettis();
        });
    </script>
</body>